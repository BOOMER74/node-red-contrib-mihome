<script type="text/javascript">
  // noinspection JSCheckFunctionSignatures,JSUnusedGlobalSymbols
  /**
   * @namespace {import('node-red__registry')}
   * @member {NodeAPI} RED
   */
  RED.nodes.registerType('mihome-cloud', {
    category: 'config',
    color: '#00BC9C',
    defaults: {
      aqara: { value: false },
      country: { value: 'ru' },
      username: { value: null },
    },
    credentials: {
      username: { type: 'text' },
      password: { type: 'password' },
    },
    paletteLabel: 'cloud',
    label() {
      const { username } = this;

      if (username == null) {
        return 'Login to Mi Home';
      }

      return `Mi Home: ${username}`;
    },
    oneditsave() {
      this.username = this.credentials.username;
    },
  });
</script>
<script type="text/html" data-template-name="mihome-cloud">
  <div class="form-row">
    <label for="node-config-input-username"><i class="fa fa-user"></i> Username</label>
    <input type="text" id="node-config-input-username" placeholder="Email / Phone number / Mi Account" />
  </div>
  <div class="form-row">
    <label for="node-config-input-password"><i class="fa fa-key"></i> Password</label>
    <input type="password" id="node-config-input-password" placeholder="Password" />
  </div>
  <div class="form-row">
    <label for="node-config-input-country"><i class="fa fa-globe"></i> Country</label>
    <select id="node-config-input-country" style="width: 70%">
      <option value="ru">ru</option>
      <option value="us">us</option>
      <option value="tw">tw</option>
      <option value="sg">sg</option>
      <option value="cn">cn</option>
      <option value="de">de</option>
    </select>
  </div>
  <div class="form-row">
    <label for="node-config-input-aqara"><i class="fa fa-plug"></i> Aqara</label>
    <label for="node-config-input-aqara" style="width: 70%">
      <input
        type="checkbox"
        id="node-config-input-aqara"
        style="display: inline-block; vertical-align: baseline; width: auto"
      />
      Enable Aqara protocol
    </label>
  </div>
</script>
<script type="text/html" data-help-name="mihome-cloud">
  <p>Provide authorization for Mi Home</p>
</script>
